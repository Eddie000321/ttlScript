; Filename: Cisco_9200_Recovery.ttl
; Description: Automates password recovery for Cisco 9200 L3 Switches.
; Reference: Page 8-9 of the documentation.

; Booting takes a long time
timeout = 600

; --- Step 1: Bypass Startup Config ---
wait 'switch:'
sendln 'SWITCH_IGNORE_STARTUP_CFG=1'
wait 'switch:'
sendln 'boot'

; --- Step 2: Erase Configuration ---
; Wait for boot to complete
wait 'Switch>'
sendln 'en'

wait 'Switch#'
sendln 'write erase'
wait 'confirm'
sendln ''

; --- Step 3: Restore Normal Boot Mode ---
wait 'Switch#'
sendln 'conf t'
wait '(config)#'
sendln 'no system ignore startupconfig switch all'
sendln 'exit'

; --- Step 4: Final Reload ---
wait 'Switch#'
sendln 'write memory'
pause 2
sendln 'reload'

; If asked to save modified config, say NO
wait 'save'
sendln 'no'

; Confirm reload if prompted again
wait 'proceed'
sendln ''

messagebox '9200 Switch recovery process complete!' 'Finished'